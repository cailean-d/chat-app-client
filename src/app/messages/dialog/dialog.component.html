<div class="chat">

  <div *ngIf="dataNotLoaded" >
    <div class="load">
      <i class="fas fa-sync fa-spin"></i>
    </div>
  </div>

  <div *ngIf="dataLoaded" >
    <div class="chat-header">
      <div class="left">
          <!-- <div *ngIf="chatService.image; else userList" > -->
            <img src="{{ chatsService.chats[chatIndex].picture }}" draggable="false" [title]="chatsService.chats[chatIndex].title"/>
          <!-- </div> -->
          <!-- <ng-template #userList>
            <div class="user" *ngFor="let user of chatService.users; let i=index">
              <div *ngIf="i<2">
                <img src="{{user.image}}" draggable="false" [title]="user.nickname"/>
              </div>
            </div>
          </ng-template> -->
          <div class="chat-about">
            <div class="chat-with">{{chatsService.chats[chatIndex].title}}</div>
            <!-- <div class="chat-num-messages">already {{messages.length}} messages</div> -->
          </div>
      </div>
      <div class="right">
          <div class="video" title="{{ 'hint.video_call' | translate }}">
              <i class="fas fa-video"></i>
          </div>
          <div class="phone" title="{{ 'hint.call' | translate }}">
              <i class="fa fa-phone"></i>
          </div>
          <div class="add-user" title="{{ 'hint.add_user' | translate }}">
              <i class="fa fa-user-plus"></i>
          </div>
      </div>
    </div>
  </div>

  <ul class="chat-history" #chat>
    <div *ngIf="dataLoaded" >
      <div class="message-list">
        <li *ngFor="let msg of chatsService.chats[chatIndex].messages" class="msg-block">
          <div [ngClass]="(msg.sender_id == user.id)?'other-message':'my-message'">
            <div class="message-data">
              <div class="row">
                  <img src="{{msg.sender_avatar}}" alt="avatar" draggable="false" title="{{msg.sender_nickname}}" (click)="showProfile(msg.sender_id)" class="av"/>
                  <span class="message-data-time" >{{msg.timestamp | mydate }}</span>
              </div>
            </div>
            <div class="msg">
              <div class="message" [innerHTML]="msg.message | message"></div>
            </div>
          </div>
        </li>
      </div>
    </div>
  </ul>

  <div class="chat-message">

    <div class="outer">
      <div class="message-input">
        <textarea name="message-to-send" id="message-to-send" placeholder ="{{ 'chat.type_message' | translate }}" #messageArea (keydown)="sendMessageOnEnterPress($event)" rows="1"></textarea>
        <div class="input-items">
          <!-- <div class="item keyboard" title="{{ 'hint.screen_keyboard' | translate }}">
              <i class="far fa-keyboard"></i>
          </div> -->
          <div class="item smiles" title="{{ 'hint.smile' | translate }}">
              <i class="far fa-smile"></i>
          </div>
          <div class="item add" title="{{ 'hint.attach_file' | translate }}">
              <i class="fas fa-paperclip"></i>
          </div>
        </div>
      </div>
    </div>

    <div class="send" title="{{ 'hint.send_message' | translate }}">
        <button (click)="sendMessage(messageArea)">
            <i class="fas fa-paper-plane"></i>
        </button>
    </div>
    <div class="scroll-bottom" (click)="scrollToBottom()" #scrollBottom>В конец</div>
  </div>

</div>
